(window.webpackJsonp=window.webpackJsonp||[]).push([[6,0,11],{105:function(t,e,r){},106:function(t,e,r){},120:function(t,e,r){"use strict";r(105)},121:function(t,e,r){"use strict";r(106)},129:function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return P}));var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page-reviews"},[e("div",{staticClass:"container container--admin"},[e("page-title",{attrs:{title:"Блок «Отзывы»"}})],1),t._v(" "),e("div",{staticClass:"container container--admin container--width"},[!0===t.editmode?e("div",{staticClass:"reviews-form"},[e("card",{attrs:{title:"Новый отзыв"}},[e("div",{attrs:{slot:"content"},slot:"content"},[e("form",{attrs:{action:"#",id:"review-form"}},[e("div",{staticClass:"reviews-form__block"},[e("div",{staticClass:"reviews-form__content"},[e("div",{staticClass:"reviews-form__avatar"},[e("div",{staticClass:"reviews-form__img"},[t.previewPhoto?e("img",{staticClass:"reviews-form__photo",attrs:{src:t.previewPhoto}}):e("div",{staticClass:"reviews-form__icon"})]),t._v(" "),e("div",{staticClass:"reviews-form__avatar-button"},[e("appButton",{attrs:{typeAttr:"file",inputAccept:".jpg, .png, .gif, .jpeg, .svg",title:"Добавить фото",errorMessage:t.validation.firstError("formData.photo"),plain:""},on:{change:t.addPhoto}})],1)]),t._v(" "),e("div",{staticClass:"reviews-form__desc"},[e("div",{staticClass:"reviews-form__user"},[e("app-input",{staticClass:"reviews-form__user-data",attrs:{placeholder:"Петров Иван",title:"Имя автора",errorMessage:t.validation.firstError("formData.author"),autofocus:"autofocus",noSidePaddings:""},model:{value:t.formData.author,callback:function(e){t.$set(t.formData,"author",e)},expression:"formData.author"}}),t._v(" "),e("app-input",{staticClass:"reviews-form__user-data",attrs:{placeholder:"Журналист",title:"Титул автора",errorMessage:t.validation.firstError("formData.occ"),noSidePaddings:""},model:{value:t.formData.occ,callback:function(e){t.$set(t.formData,"occ",e)},expression:"formData.occ"}})],1),t._v(" "),e("div",{staticClass:"reviews-form__text"},[e("app-input",{attrs:{title:"Отзыв",fieldType:"textarea",errorMessage:t.validation.firstError("formData.text")},model:{value:t.formData.text,callback:function(e){t.$set(t.formData,"text",e)},expression:"formData.text"}})],1)])]),t._v(" "),e("div",{staticClass:"reviews-form__buttons"},[e("div",{staticClass:"reviews-form__button"},[e("appButton",{attrs:{plain:"",title:"Отмена"},on:{click:t.clearFields}})],1),t._v(" "),e("div",{staticClass:"reviews-form__button"},[e("appButton",{attrs:{title:"Сохранить"},on:{click:t.onApprove}})],1)])])])])])],1):t._e(),t._v(" "),e("ul",{staticClass:"reviews__list"},[e("li",{staticClass:"reviews__item"},[e("square-button",{attrs:{type:"square",title:"Добавить отзыв"},on:{click:function(e){t.editmode=!0}}})],1),t._v(" "),t._l(t.reviews,(function(r,i){return e("li",{key:r.id,staticClass:"reviews__item"},[e("review",{attrs:{editmode:t.editmode},on:{editmodeOn:t.editmodeActive},model:{value:t.reviews[i],callback:function(e){t.$set(t.reviews,i,e)},expression:"reviews[i]"}})],1)}))],2)])])};i._withStripped=!0;var a=r(1),s=r.n(a),o=r(44),n=r.n(o),c=r(0),l=r.n(c),u=r(95),d=r(89),p=r(90),v=function(){var t=this,e=t._self._c;return e("div",{staticClass:"review-component",class:{"review-component--active":t.classActive}},[e("card",[e("div",{staticClass:"review__title",attrs:{slot:"title"},slot:"title"},[e("user",{attrs:{avatar:"https://webdev-api.loftschool.com/".concat(t.value.photo),userName:t.value.author,profession:t.value.occ}})],1),t._v(" "),e("div",{staticClass:"review__text",attrs:{slot:"content"},slot:"content"},[e("p",{staticClass:"text"},[t._v(t._s(t.value.text))]),t._v(" "),e("div",{staticClass:"review__buttons"},[e("div",{staticClass:"button-icon",on:{click:function(e){t.$emit("editmodeOn",t.value),t.classActive=!0}}},[e("icon",{attrs:{symbol:"pencil",title:"Править"}})],1),t._v(" "),e("div",{staticClass:"button-icon",on:{click:t.removeExistedReview}},[e("icon",{attrs:{symbol:"cross",title:"Удалить"}})],1)])])])],1)};v._withStripped=!0;var f=r(57),m=r(96),h=r(9);function _(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function w(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?_(Object(r),!0).forEach((function(e){n()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var b={components:{card:d.a,user:f.a,icon:m.default},props:{value:Object,editmode:Boolean},data:function(){return{classActive:!1}},methods:w(w({},Object(h.b)("reviews",["removeReview"])),{},{removeExistedReview:function(){var t=this;return s()(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.removeReview(t.value.id);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))()}}),watch:{editmode:function(){this.editmode||(this.classActive=!1)}}},g=(r(120),r(5)),y=Object(g.a)(b,v,[],!1,null,"7097a18f",null).exports,C=r(91),O=r(43);function x(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function j(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?x(Object(r),!0).forEach((function(e){n()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var D={mixins:[r(43).mixin],validators:{"formData.author":function(t){return O.Validator.value(t).required("ЗАПОЛНИТЕ ПОЛЕ")},"formData.occ":function(t){return O.Validator.value(t).required("ЗАПОЛНИТЕ ПОЛЕ")},"formData.text":function(t){return O.Validator.value(t).required("ЗАПОЛНИТЕ ПОЛЕ")},"formData.photo":function(t){return O.Validator.value(t).required("ДОБАВЬТЕ ИЗОБРАЖЕНИЕ")}},components:{pageTitle:u.a,card:d.a,appInput:C.default,squareButton:p.a,appButton:p.a,review:y},data:function(){return{formData:{id:0,photo:"",author:"",occ:"",text:"Этот парень молодец ..."},previewPhoto:"",editmode:!1}},computed:j({},Object(h.c)("reviews",{reviews:function(t){return t.reviews}})),methods:j(j(j({},Object(h.b)("reviews",["fetchReviews","addReview","editReview"])),Object(h.b)("notifs",["showError"])),{},{clearFields:function(){this.formData.id=0,this.formData.photo="",this.formData.author="",this.formData.occ="",this.formData.text="Этот парень молодец ...",this.editmode=!1,this.previewPhoto="",this.validation.reset()},onApprove:function(){var t=this;this.$validate().then(function(){var e=s()(l.a.mark((function e(r){var i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=26;break}if(i=new FormData,Object.keys(t.formData).forEach((function(e){return i.append(e,t.formData[e])})),0!=t.formData.id){e.next=16;break}return e.prev=4,e.next=7,t.addReview(i);case 7:t.clearFields(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(4),console.log(e.t0),t.showError(e.t0.response.data.error);case 14:e.next=26;break;case 16:return e.prev=16,e.next=19,t.editReview(i);case 19:t.clearFields(),e.next=26;break;case 22:e.prev=22,e.t1=e.catch(16),console.log(e.t1),t.showError(e.t1.response.data.error);case 26:case"end":return e.stop()}}),e,null,[[4,10],[16,22]])})));return function(t){return e.apply(this,arguments)}}())},editmodeActive:function(t){this.formData=j({},t),this.previewPhoto="https://webdev-api.loftschool.com/".concat(t.photo),this.editmode=!0,window.scrollTo(0,290)},addPhoto:function(t){var e=t.srcElement.files[0];if(!["image/jpeg","image/png","image/gif","image/svg+xml"].includes(e.type))return this.showError("Разрешены только изображения"),void(this.formData.photo="");e.size>1572864?this.showError("Файл должен быть менее 1.5 МБ"):(this.formData.photo=e,this.previewPhoto=URL.createObjectURL(e))}}),created:function(){try{this.fetchReviews(this.$store.getters["user/getUserId"])}catch(t){console.log(t),this.showError(t.response.data.error)}}},P=(r(121),Object(g.a)(D,i,[],!1,null,"73d2be06",null).exports)},84:function(t,e,r){},85:function(t,e,r){},86:function(t,e,r){},87:function(t,e,r){},88:function(t,e,r){"use strict";r(84)},89:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var i=function(){var t=this,e=t._self._c;return t.simple?e("div",{staticClass:"card-component card-plain"},[t._t("default")],2):e("div",{staticClass:"card-component"},[e("div",{staticClass:"card-header"},[e("div",{staticClass:"card-text",domProps:{textContent:t._s(t.title)}}),t._v(" "),!1==!!t.title?t._t("title"):t._e()],2),t._v(" "),e("div",{staticClass:"card-content"},[t._t("content")],2)])};i._withStripped=!0;var a={props:{title:{type:String,default:""},simple:Boolean}},s=(r(93),r(5)),o=Object(s.a)(a,i,[],!1,null,"5ab73c68",null).exports},90:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var i=function(){return(0,this._self._c)(this.type,this._g(this._b({tag:"component"},"component",this.$attrs,!1),this.$listeners))};i._withStripped=!0;var a={props:{type:{type:String,default:"default"}},components:{default:function(){return r.e(7).then(r.bind(null,131))},square:function(){return r.e(10).then(r.bind(null,132))},iconed:function(){return r.e(8).then(r.bind(null,133))},round:function(){return r.e(9).then(r.bind(null,135))}}},s=r(5),o=Object(s.a)(a,i,[],!1,null,null,null).exports},91:function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return o}));var i=function(){var t=this,e=t._self._c;return"input"===t.fieldType?e("label",{staticClass:"input",class:[{input_labeled:!!t.title,"no-side-paddings":t.noSidePaddings},t.iconClass,{error:!!t.errorMessage}]},[t.title?e("div",{staticClass:"input__title"},[t._v(t._s(t.title))]):t._e(),t._v(" "),e("input",t._b({staticClass:"input__elem field__elem",domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}},"input",t.$attrs,!1)),t._v(" "),e("div",{staticClass:"input__error-tooltip"},[e("tooltip",{attrs:{text:t.errorMessage}})],1)]):"textarea"===t.fieldType?e("label",t._b({staticClass:"textarea",class:{error:!!t.errorMessage}},"label",t.$attrs,!1),[t.title?e("div",{staticClass:"input__title"},[t._v(t._s(t.title))]):t._e(),t._v(" "),e("textarea",{staticClass:"textarea__elem field__elem",class:{error:!!t.errorMessage},domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}}),t._v(" "),e("div",{staticClass:"input__error-tooltip"},[e("tooltip",{attrs:{text:t.errorMessage}})],1)]):t._e()};i._withStripped=!0;var a={inheritAttrs:!1,props:{title:{type:String,default:""},errorMessage:{type:String,default:""},noSidePaddings:Boolean,fieldType:{type:String,default:"input"},value:String|Number,icon:{type:String,default:"",validator:function(t){return["","user","key"].includes(t)}}},computed:{iconClass:function(){var t=this.icon;return t.length?" input_iconed input_icon-".concat(t):""}},components:{tooltip:function(){return r.e(1).then(r.bind(null,134))}}},s=(r(88),r(5)),o=Object(s.a)(a,i,[],!1,null,"91801324",null).exports},92:function(t,e,r){"use strict";r(85)},93:function(t,e,r){"use strict";r(86)},94:function(t,e,r){"use strict";r(87)},95:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var i=function(){var t=this._self._c;return t("div",{staticClass:"page-title-component"},[t("div",{staticClass:"admin-header"},[t("div",{staticClass:"admin-title"},[this._v(this._s(this.title))]),this._v(" "),this._t("default")],2)])};i._withStripped=!0;var a={components:{},props:{title:String}},s=(r(92),r(5)),o=Object(s.a)(a,i,[],!1,null,"22efb2d4",null).exports},96:function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return o}));var i=function(){return(0,this._self._c)("button",this._g({class:["icon-component",this.iconClass,{grayscale:this.grayscale},{"no-words":!1==!!this.title}],attrs:{"data-text":this.title,type:"button"}},this.$listeners))};i._withStripped=!0;var a={props:{symbol:{type:String,default:"pencil",validator:function(t){return["pencil","cross","tick","trash"].includes(t)}},grayscale:{type:Boolean},title:{type:String,default:""}},computed:{iconClass:function(){return"is-".concat(this.symbol)}}},s=(r(94),r(5)),o=Object(s.a)(a,i,[],!1,null,"3ff23cc5",null).exports}}]);