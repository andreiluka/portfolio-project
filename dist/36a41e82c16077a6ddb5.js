(window.webpackJsonp=window.webpackJsonp||[]).push([[4,0,11],{102:function(t,e,r){},103:function(t,e,r){},104:function(t,e,r){},117:function(t,e,r){"use strict";r(102)},118:function(t,e,r){"use strict";r(103)},119:function(t,e,r){"use strict";r(104)},128:function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return S}));var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page-projects"},[e("div",{staticClass:"container container--admin"},[e("page-title",{attrs:{title:"Блок «Работы»"}})],1),t._v(" "),e("div",{staticClass:"container container--admin container--width"},[!0===t.editmode?e("div",{staticClass:"projects-form"},[e("card",{attrs:{title:"Редактирование работы"}},[e("div",{attrs:{slot:"content"},slot:"content"},[e("form",{attrs:{action:"#",id:"project-form"}},[e("div",{staticClass:"projects-form__block"},[e("div",{staticClass:"projects-form__content"},[e("div",{staticClass:"projects-form__avatar"},[e("label",{staticClass:"projects-form__img",class:{"projects-form__img--dragover":t.dragover},on:{dragover:function(e){e.preventDefault(),t.dragover=!0},dragleave:function(e){t.dragover=!1},drop:function(e){return e.preventDefault(),t.addPhoto.apply(null,arguments)}}},[t.previewPhoto?e("img",{staticClass:"projects-form__photo",attrs:{src:t.previewPhoto}}):e("div",{staticClass:"projects-form__img-block"},[e("div",{staticClass:"projects-form__img-text"},[t._v("\n                                    Перетащите или загрузите \n                                    для загрузки изображения\n                                 ")]),t._v(" "),e("div",{staticClass:"projects-form__img-button"},[e("appButton",{attrs:{typeAttr:"file",inputAccept:".jpg, .png, .gif, .jpeg, .svg",title:"загрузить",errorMessage:t.validation.firstError("formData.photo")},on:{change:t.addPhoto}})],1)])]),t._v(" "),t.previewPhoto?e("div",{staticClass:"projects-form__change-button"},[e("appButton",{attrs:{typeAttr:"file",inputAccept:".jpg, .png, .gif, .jpeg, .svg",title:"Изменить превью",errorMessage:t.validation.firstError("formData.photo"),plain:""},on:{change:t.addPhoto}})],1):t._e()]),t._v(" "),e("div",{staticClass:"projects-form__desc"},[e("div",{staticClass:"projects-form__general"},[e("app-input",{staticClass:"projects-form__general-data",attrs:{placeholder:"Название проекта",title:"Название",errorMessage:t.validation.firstError("formData.title"),autofocus:"autofocus",noSidePaddings:""},model:{value:t.formData.title,callback:function(e){t.$set(t.formData,"title",e)},expression:"formData.title"}}),t._v(" "),e("app-input",{staticClass:"projects-form__general-data",attrs:{placeholder:"https://www.address.com",title:"Ссылка",errorMessage:t.validation.firstError("formData.link"),noSidePaddings:""},model:{value:t.formData.link,callback:function(e){t.$set(t.formData,"link",e)},expression:"formData.link"}})],1),t._v(" "),e("div",{staticClass:"projects-form__text"},[e("app-input",{attrs:{title:"Описание",fieldType:"textarea",errorMessage:t.validation.firstError("formData.description")},model:{value:t.formData.description,callback:function(e){t.$set(t.formData,"description",e)},expression:"formData.description"}})],1),t._v(" "),e("tags-adder",{attrs:{errorMessage:t.validation.firstError("formData.techs")},on:{removeTag:t.editTags},model:{value:t.formData.techs,callback:function(e){t.$set(t.formData,"techs",e)},expression:"formData.techs"}})],1)]),t._v(" "),e("div",{staticClass:"projects-form__buttons"},[e("div",{staticClass:"projects-form__button"},[e("appButton",{attrs:{plain:"",title:"Отмена"},on:{click:t.clearFields}})],1),t._v(" "),e("div",{staticClass:"projects-form__button"},[e("appButton",{attrs:{title:"Сохранить"},on:{click:t.onApprove}})],1)])])])])])],1):t._e(),t._v(" "),e("ul",{staticClass:"projects__list"},[e("li",{staticClass:"projects__item"},[e("square-button",{attrs:{type:"square",title:"Добавить работу"},on:{click:function(e){t.editmode=!0}}})],1),t._v(" "),t._l(t.projects,(function(r,i){return e("li",{key:r.id,staticClass:"projects__item"},[e("project",{attrs:{editmode:t.editmode},on:{editmodeOn:t.editmodeActive},model:{value:t.projects[i],callback:function(e){t.$set(t.projects,i,e)},expression:"projects[i]"}})],1)}))],2)])])};i._withStripped=!0;var a=r(1),s=r.n(a),o=r(44),n=r.n(o),c=r(0),l=r.n(c),u=r(95),p=r(89),d=r(90),f=function(){var t=this,e=t._self._c;return e("div",{staticClass:"project-component",class:{"project-component--active":t.classActive}},[e("card",{attrs:{simple:""}},[e("div",{staticClass:"project__img"},[e("img",{staticClass:"project__pic",attrs:{src:"https://webdev-api.loftschool.com/".concat(t.value.photo),alt:""}})]),t._v(" "),e("div",{staticClass:"project__desc"},[e("div",{staticClass:"project__text"},[e("div",{staticClass:"project__title"},[t._v(t._s(t.value.title))]),t._v(" "),e("p",{staticClass:"text"},[t._v(t._s(t.value.description))]),t._v(" "),e("a",{staticClass:"project__link",attrs:{href:t.value.link,target:"_blank"}},[t._v(t._s(t.value.link))])]),t._v(" "),e("div",{staticClass:"project__buttons"},[e("div",{staticClass:"button-icon",on:{click:function(e){t.$emit("editmodeOn",t.value),t.classActive=!0}}},[e("icon",{attrs:{symbol:"pencil",title:"Править"}})],1),t._v(" "),e("div",{staticClass:"button-icon",on:{click:t.removeExistedProject}},[e("icon",{attrs:{symbol:"cross",title:"Удалить"}})],1)])])])],1)};f._withStripped=!0;var v=r(96),m=r(9);function _(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function h(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?_(Object(r),!0).forEach((function(e){n()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var g={components:{card:p.a,icon:v.default},props:{value:Object,editmode:Boolean},data:function(){return{classActive:!1}},methods:h(h({},Object(m.b)("projects",["removeProject"])),{},{removeExistedProject:function(){var t=this;return s()(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.removeProject(t.value.id);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))()}}),watch:{editmode:function(){this.editmode||(this.classActive=!1)}}},b=(r(117),r(5)),j=Object(b.a)(g,f,[],!1,null,"03b7a45e",null).exports,y=r(91),C=function(){var t=this,e=t._self._c;return e("div",{staticClass:"tags-adder-component"},[e("app-input",{attrs:{placeholder:"Перечислите теги через запятую",title:"Добавление тега",value:t.value,autofocus:"autofocus","no-side-paddings":"",errorMessage:t.errorMessage},on:{input:function(e){return t.$emit("input",e)}}}),t._v(" "),e("ul",{staticClass:"tags-adder__list"},t._l(t.tagsArray,(function(r,i){return e("li",{key:i,staticClass:"tags-adder__item"},[e("span",{staticClass:"tags-adder__item-name"},[t._v(t._s(r))]),t._v(" "),e("span",{staticClass:"tags-adder__item-cross"},[e("icon",{style:{width:"10px"},attrs:{symbol:"cross"},on:{click:function(e){return t.removeTag(i)}}})],1)])})),0)],1)};C._withStripped=!0;var w={components:{icon:function(){return Promise.resolve().then(r.bind(null,96))},appInput:function(){return Promise.resolve().then(r.bind(null,91))}},props:{value:{type:String,default:""},errorMessage:{type:String,default:""}},computed:{tagsArray:function(){return this.value.split(", ").filter((function(t){return t.trim()}))}},methods:{removeTag:function(t){var e=this.tagsArray.filter((function(e,r){return r!==t})).join(", ");this.$emit("removeTag",e)}}},O=(r(118),Object(b.a)(w,C,[],!1,null,"1506c27b",null).exports),D=r(43);function P(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function x(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?P(Object(r),!0).forEach((function(e){n()(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var k={mixins:[r(43).mixin],validators:{"formData.title":function(t){return D.Validator.value(t).required("ЗАПОЛНИТЕ ПОЛЕ")},"formData.link":function(t){return D.Validator.value(t).required("ЗАПОЛНИТЕ ПОЛЕ")},"formData.description":function(t){return D.Validator.value(t).required("ЗАПОЛНИТЕ ПОЛЕ")},"formData.techs":function(t){return D.Validator.value(t).required("ЗАПОЛНИТЕ ПОЛЕ")},"formData.photo":function(t){return D.Validator.value(t).required("ДОБАВЬТЕ ИЗОБРАЖЕНИЕ")}},components:{pageTitle:u.a,card:p.a,appInput:y.default,squareButton:d.a,appButton:d.a,project:j,tagsAdder:O},data:function(){return{formData:{id:0,photo:"",title:"",link:"",description:"",techs:"HTML, CSS, Javascript"},previewPhoto:"",editmode:!1,dragover:!1}},computed:x({},Object(m.c)("projects",{projects:function(t){return t.projects}})),methods:x(x(x({},Object(m.b)("projects",["fetchProjects","addProject","editProject"])),Object(m.b)("notifs",["showError"])),{},{clearFields:function(){this.formData.id=0,this.formData.photo="",this.formData.title="",this.formData.link="",this.formData.description="",this.formData.techs="HTML, CSS, Javascript",this.editmode=!1,this.previewPhoto="",this.validation.reset()},onApprove:function(){var t=this;this.$validate().then(function(){var e=s()(l.a.mark((function e(r){var i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=26;break}if(i=new FormData,Object.keys(t.formData).forEach((function(e){return i.append(e,t.formData[e])})),0!==t.formData.id){e.next=16;break}return e.prev=4,e.next=7,t.addProject(i);case 7:t.clearFields(),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(4),console.log(e.t0),t.showError(e.t0.response.data.error);case 14:e.next=26;break;case 16:return e.prev=16,e.next=19,t.editProject(i);case 19:t.clearFields(),e.next=26;break;case 22:e.prev=22,e.t1=e.catch(16),console.log(e.t1),t.showError(e.t1.response.data.error);case 26:case"end":return e.stop()}}),e,null,[[4,10],[16,22]])})));return function(t){return e.apply(this,arguments)}}())},editmodeActive:function(t){this.formData=x({},t),this.previewPhoto="https://webdev-api.loftschool.com/".concat(t.photo),this.editmode=!0,window.scrollTo(0,290)},editTags:function(t){this.formData.techs=t},addPhoto:function(t){this.dragover=!1;var e="drop"==t.type?t.dataTransfer.files[0]:t.srcElement.files[0];if(!["image/jpeg","image/png","image/gif","image/svg+xml"].includes(e.type))return this.showError("Разрешены только изображения"),void(this.formData.photo="");e.size>1572864?this.showError("Файл должен быть менее 1.5 МБ"):(this.formData.photo=e,this.previewPhoto=URL.createObjectURL(e))}}),created:function(){try{this.fetchProjects(this.$store.getters["user/getUserId"])}catch(t){console.log(t),this.showError(t.response.data.error)}}},S=(r(119),Object(b.a)(k,i,[],!1,null,"06e07286",null).exports)},84:function(t,e,r){},85:function(t,e,r){},86:function(t,e,r){},87:function(t,e,r){},88:function(t,e,r){"use strict";r(84)},89:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var i=function(){var t=this,e=t._self._c;return t.simple?e("div",{staticClass:"card-component card-plain"},[t._t("default")],2):e("div",{staticClass:"card-component"},[e("div",{staticClass:"card-header"},[e("div",{staticClass:"card-text",domProps:{textContent:t._s(t.title)}}),t._v(" "),!1==!!t.title?t._t("title"):t._e()],2),t._v(" "),e("div",{staticClass:"card-content"},[t._t("content")],2)])};i._withStripped=!0;var a={props:{title:{type:String,default:""},simple:Boolean}},s=(r(93),r(5)),o=Object(s.a)(a,i,[],!1,null,"5ab73c68",null).exports},90:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var i=function(){return(0,this._self._c)(this.type,this._g(this._b({tag:"component"},"component",this.$attrs,!1),this.$listeners))};i._withStripped=!0;var a={props:{type:{type:String,default:"default"}},components:{default:function(){return r.e(7).then(r.bind(null,131))},square:function(){return r.e(10).then(r.bind(null,132))},iconed:function(){return r.e(8).then(r.bind(null,133))},round:function(){return r.e(9).then(r.bind(null,135))}}},s=r(5),o=Object(s.a)(a,i,[],!1,null,null,null).exports},91:function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return o}));var i=function(){var t=this,e=t._self._c;return"input"===t.fieldType?e("label",{staticClass:"input",class:[{input_labeled:!!t.title,"no-side-paddings":t.noSidePaddings},t.iconClass,{error:!!t.errorMessage}]},[t.title?e("div",{staticClass:"input__title"},[t._v(t._s(t.title))]):t._e(),t._v(" "),e("input",t._b({staticClass:"input__elem field__elem",domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}},"input",t.$attrs,!1)),t._v(" "),e("div",{staticClass:"input__error-tooltip"},[e("tooltip",{attrs:{text:t.errorMessage}})],1)]):"textarea"===t.fieldType?e("label",t._b({staticClass:"textarea",class:{error:!!t.errorMessage}},"label",t.$attrs,!1),[t.title?e("div",{staticClass:"input__title"},[t._v(t._s(t.title))]):t._e(),t._v(" "),e("textarea",{staticClass:"textarea__elem field__elem",class:{error:!!t.errorMessage},domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}}),t._v(" "),e("div",{staticClass:"input__error-tooltip"},[e("tooltip",{attrs:{text:t.errorMessage}})],1)]):t._e()};i._withStripped=!0;var a={inheritAttrs:!1,props:{title:{type:String,default:""},errorMessage:{type:String,default:""},noSidePaddings:Boolean,fieldType:{type:String,default:"input"},value:String|Number,icon:{type:String,default:"",validator:function(t){return["","user","key"].includes(t)}}},computed:{iconClass:function(){var t=this.icon;return t.length?" input_iconed input_icon-".concat(t):""}},components:{tooltip:function(){return r.e(1).then(r.bind(null,134))}}},s=(r(88),r(5)),o=Object(s.a)(a,i,[],!1,null,"91801324",null).exports},92:function(t,e,r){"use strict";r(85)},93:function(t,e,r){"use strict";r(86)},94:function(t,e,r){"use strict";r(87)},95:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var i=function(){var t=this._self._c;return t("div",{staticClass:"page-title-component"},[t("div",{staticClass:"admin-header"},[t("div",{staticClass:"admin-title"},[this._v(this._s(this.title))]),this._v(" "),this._t("default")],2)])};i._withStripped=!0;var a={components:{},props:{title:String}},s=(r(92),r(5)),o=Object(s.a)(a,i,[],!1,null,"22efb2d4",null).exports},96:function(t,e,r){"use strict";r.r(e),r.d(e,"default",(function(){return o}));var i=function(){return(0,this._self._c)("button",this._g({class:["icon-component",this.iconClass,{grayscale:this.grayscale},{"no-words":!1==!!this.title}],attrs:{"data-text":this.title,type:"button"}},this.$listeners))};i._withStripped=!0;var a={props:{symbol:{type:String,default:"pencil",validator:function(t){return["pencil","cross","tick","trash"].includes(t)}},grayscale:{type:Boolean},title:{type:String,default:""}},computed:{iconClass:function(){return"is-".concat(this.symbol)}}},s=(r(94),r(5)),o=Object(s.a)(a,i,[],!1,null,"3ff23cc5",null).exports}}]);